(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d5decc6a"],{"0ce8":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content-body"},[i("div",{staticClass:"table-action"},[i("div",{staticClass:"lf"},[i("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入活动主题进行查询",size:"small"},on:{input:t.goSearch},model:{value:t.searchInfo,callback:function(e){t.searchInfo=e},expression:"searchInfo"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.searchActivityInfo},slot:"append"})],1)],1),i("div",{staticClass:"rt"},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.addclick}},[t._v("新增")]),i("el-button",{attrs:{size:"small",type:"info",icon:"el-icon-edit"},on:{click:function(e){return t.handleEdit(t.valLength,t.multipleSelection)}}},[t._v("编辑")]),i("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(e){return t.deleteClick(t.valLength,t.multipleSelection)}}},[t._v("删除")])],1)]),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",stripe:"",data:t.pageDataList,"tooltip-effect":"dark",height:t.tableHeight,"element-loading-text":"拼命加载中","element-loading-background":"rgba(255, 255, 255, 0.8)"},on:{"row-click":t.handleRowClick,"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"80",fixed:""}}),i("el-table-column",{attrs:{label:"编号",type:"index",width:"80"}}),i("el-table-column",{attrs:{label:"活动图片/视频(点击预览)",prop:"activityPreviewImg",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",["image"==t.getFileType(e.row.activityPreviewImg)?i("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{src:e.row.activityPreviewImg,fit:"scale-down","preview-src-list":t.activityImgAll}}):i("div",{staticClass:"triangle-right",on:{click:function(i){return t.playVideo(e.row)}}},[i("i",{staticClass:"el-icon-caret-right"})])],1)]}}])}),i("el-table-column",{attrs:{label:"活动主题",prop:"activityIntro",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tooltip",{staticClass:"schoolSynopsis",attrs:{effect:"light",content:e.row.activityIntro,placement:"top-start","show-overflow-tooltip":"true"}},[e.row.activityIntro.length>20?i("div",[t._v(" "+t._s(e.row.activityIntro.substring(0,20))+"... ")]):i("div",[t._v(t._s(e.row.activityIntro))])])]}}])}),i("el-table-column",{attrs:{label:"创建人",sortable:"",prop:"activityCreator",width:"150"}}),i("el-table-column",{attrs:{label:"创建时间",sortable:"",prop:"activityCreationTime",width:"200"}}),i("el-table-column",{attrs:{label:"编辑人",sortable:"",prop:"activityEditor",width:"150"}}),i("el-table-column",{attrs:{label:"最后一次编辑的时间",sortable:"",prop:"activityEditSession",width:"200"}})],1),i("div",{staticClass:"table-page__action"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper",total:t.pageCount,"page-size":15},on:{"current-change":t.changePage}})],1),i("el-dialog",{attrs:{title:"新增活动信息",width:"700px","close-on-click-modal":!1,visible:t.isaddmaskshow},on:{"update:visible":function(e){t.isaddmaskshow=e}}},[t.isaddmaskshow?i("TheForm",{ref:"newForm"}):t._e(),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"noadd",on:{click:t.noaddclick}},[t._v("取消")]),i("el-button",{staticClass:"okadd",attrs:{type:"primary"},on:{click:t.okaddclick}},[t._v("确认")])],1)],1),i("el-dialog",{attrs:{title:"编辑活动信息",width:"900px","close-on-click-modal":!1,visible:t.iseditmaskshow},on:{"update:visible":function(e){t.iseditmaskshow=e}}},[t.iseditmaskshow?i("TheForm",{ref:"editForm",attrs:{type:"edit"}}):t._e(),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"noedit",on:{click:t.noEditclick}},[t._v("取消")]),i("el-button",{staticClass:"okedit",attrs:{type:"primary"},on:{click:t.okEditclick}},[t._v("确认")])],1)],1),i("el-dialog",{attrs:{title:t.currentVideotitle,"destroy-on-close":"",visible:t.isPlayVideoshow,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(e){t.isPlayVideoshow=e}}},[i("video",{staticClass:"videoBox",attrs:{src:t.currentVideoAddress,width:"100%",height:"600",controls:""}})])],1)},a=[],o=(i("caad"),i("a15b"),i("d81d"),i("d3b7"),i("ac1f"),i("1276"),i("5530")),r=(i("96cf"),i("1da1")),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.form?i("el-form",{ref:"form",attrs:{"label-width":"80px",model:t.form,rules:t.rules}},[i("el-form-item",{ref:"uploadForm",staticClass:"upload-img-form",attrs:{prop:"activityPreviewImg",label:"上传文件"}},[i("upload",{attrs:{params:{companyId:t.companyId},accept:"image/*,video/*"},model:{value:t.form.activityPreviewImg,callback:function(e){t.$set(t.form,"activityPreviewImg",e)},expression:"form.activityPreviewImg"}}),i("div",{},[t._v("(注：支持图片/视频)")])],1),i("el-form-item",{attrs:{label:"活动主题",prop:"activityIntro"}},[i("el-input",{attrs:{placeholder:"请输入标题"},model:{value:t.form.activityIntro,callback:function(e){t.$set(t.form,"activityIntro",e)},expression:"form.activityIntro"}})],1)],1):t._e()},c=[],l=i("9dac"),u=i("4260"),d={props:{type:{type:String,default:"new"}},name:"",components:{upload:l["a"]},data:function(){return{rules:{activityPreviewImg:[{required:!0,message:"请上传图片",trigger:"blur"}],activityIntro:[{required:!0,message:"请输入主标题",trigger:"blur"}],activityId:[{required:!0,message:"请选择活动主题",trigger:"blur"}]},form:{activityPreviewImg:"",activityIntro:""},companyId:"",defaultForm:{}}},watch:{},created:function(){this.init();var t=sessionStorage.getItem("companyId",t);this.companyId=t},mounted:function(){},methods:{isPass:function(){var t=this;return new Promise((function(e){var i=t.$refs.form;i.validate((function(t){e(t)}))}))},init:function(){this.defaultForm=Object(u["a"])(this.form)},getValue:function(){var t=Object(u["a"])(this.form);return t},setValue:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.form=Object(u["a"])(t)},reset:function(){this.form=Object(u["a"])(this.defaultForm),this.$refs.form.resetFields()}},computed:{},filters:{}},m=d,g=i("2877"),f=Object(g["a"])(m,s,c,!1,null,"227b47a8",null),h=f.exports,p=i("4124"),v={components:{TheForm:h},data:function(){return{tableHeight:window.innerHeight-210,tableData:[],activityImgAll:[],editContent:"",imgList:[],schoolId:"",isaddmaskshow:!1,iseditmaskshow:!1,filePath:"",multipleSelection:[],valLength:"",selectUploadFileBtn:!0,searchInfo:"",page:1,pageCount:null,pageDataList:[],ActivitieList:[],adminName:"",newactivity_img:[],editActivity_img:[],imgFilesList:[],loading:!1,isPlayVideoshow:!1,currentVideoAddress:"",currentVideotitle:""}},methods:{handleSelectionChange:function(t){this.multipleSelection=t,this.valLength=t.length},handleRowClick:function(t,e,i){this.$refs.multipleTable.toggleRowSelection(t)},getFileType:function(t){var e=t.split(".").pop().toLocaleLowerCase();return["mov","rmvb","rm","FLV","mp4","3GP","avi"].includes(e)?"video":"image"},addConsult:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.newForm.isPass();case 2:if(i=e.sent,0!=i){e.next=5;break}return e.abrupt("return");case 5:n=t.$refs.newForm.getValue(),t.loading=!0,Object(p["a"])(Object(o["a"])(Object(o["a"])({},n),{},{schoolId:t.schoolId,activityCreator:t.adminName})).then((function(e){1==e.code?t.$message.error(e.msg):(t.isaddmaskshow=!1,t.$message.success(e.msg),t.getChangePage({page:t.page,limit:15}))})).finally((function(){t.loading=!1}));case 8:case"end":return e.stop()}}),e)})))()},addclick:function(){var t=this;this.isaddmaskshow=!0,this.$nextTick((function(){t.$refs.newForm.reset()}))},noaddclick:function(){this.isaddmaskshow=!1},okaddclick:function(){this.addConsult()},EditInfo:function(){var t=this;this.editContent.activityImg=this.imgFilesList.map((function(t){return t.url}));var e=this.$refs.editForm.getValue();this.loading=!0,Object(p["m"])(Object(o["a"])(Object(o["a"])({},e),{},{schoolId:this.schoolId,activityEditor:this.adminName})).then((function(e){t.iseditmaskshow=!1,1==e.code?t.$message.error(e.msg):(t.$message.success(e.msg),t.getChangePage({page:t.page,limit:15}))})).finally((function(){t.loading=!1}))},handleEdit:function(t,e){var i=this;if(t){if(1==t)this.iseditmaskshow=!0,this.editContent=Object(u["a"])(e[0]),this.imgFilesList=this.editContent.activityImg.map((function(t){return{url:t}})),this.$nextTick((function(){i.$refs.editForm.reset(),i.$refs.editForm.setValue(i.editContent)}));else if(t>1)return void this.$message.error("您只能选择一个要编辑的内容")}else this.$message.error("您还未选择要编辑的内容")},okEditclick:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.editForm.isPass();case 2:if(i=e.sent,0!=i){e.next=5;break}return e.abrupt("return");case 5:t.iseditmaskshow=!1,t.EditInfo();case 7:case"end":return e.stop()}}),e)})))()},noEditclick:function(){this.iseditmaskshow=!1},deleteClick:function(t,e){var i=this;if(t){for(var n=[],a=0;a<e.length;a++){var o=e[a].activityId;n.push(o)}this.$confirm("确认要删除吗？").then((function(){i.loading=!0,Object(p["e"])({activityIds:n.join(",")}).then((function(t){1==t.code?i.$message.error(t.msg):(i.$message.success(t.msg),i.getChangePage({page:i.page,limit:15}))})).finally((function(){i.loading=!1}))}))}else this.$message.error("您还未选择要删除的内容")},getChangePage:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,Object(p["i"])(Object(o["a"])(Object(o["a"])({},e),{},{schoolId:this.schoolId})).then((function(e){var i=e.data;t.pageCount=e.pageCount,t.pageDataList=e.data;for(var n=[],a=0;a<i.length;a++){var o=i[a].activityPreviewImg;n.push(o)}t.activityImgAll=n})).finally((function(){t.loading=!1}))},changePage:function(t){this.page=t,this.getChangePage({page:t,limit:15})},goSearch:function(){var t=this;this.searchInfo;clearTimeout(this.timeout),this.timeout=setTimeout((function(){t.getChangePage({ActivityName:t.searchInfo,page:1,limit:15})}),300)},searchActivityInfo:function(){this.getChangePage({ActivityName:this.searchInfo,page:1,limit:15})},playVideo:function(t){this.isPlayVideoshow=!0,this.currentVideoAddress=t.activityPreviewImg,this.currentVideotitle=t.activityIntro}},mounted:function(){var t=sessionStorage.getItem("schoolId",t);this.schoolId=t;var e=sessionStorage.getItem("adminName",e);this.adminName=e,this.getChangePage({page:1,limit:15})}},b=v,y=(i("64c8"),i("d928"),i("bf32"),Object(g["a"])(b,n,a,!1,null,"a76b0b0a",null));e["default"]=y.exports},"151d":function(t,e,i){},4124:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"n",(function(){return o})),i.d(e,"f",(function(){return r})),i.d(e,"j",(function(){return s})),i.d(e,"d",(function(){return c})),i.d(e,"p",(function(){return l})),i.d(e,"h",(function(){return u})),i.d(e,"l",(function(){return d})),i.d(e,"a",(function(){return m})),i.d(e,"m",(function(){return g})),i.d(e,"e",(function(){return f})),i.d(e,"i",(function(){return h})),i.d(e,"c",(function(){return p})),i.d(e,"o",(function(){return v})),i.d(e,"g",(function(){return b})),i.d(e,"k",(function(){return y}));var n=i("b775");function a(t){return Object(n["a"])({url:"/addColorImg",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/updateColorImg",method:"post",data:t})}function r(t){return Object(n["a"])({url:"/deleteColorImg",method:"get",params:t})}function s(t){return Object(n["a"])({url:"/limitColorImg",method:"get",params:t})}function c(t){return Object(n["a"])({url:"/addPoster",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/updatePoster",method:"post",data:t})}function u(t){return Object(n["a"])({url:"/deletePoster",method:"get",params:t})}function d(t){return Object(n["a"])({url:"/limitPosters",method:"get",params:t})}function m(t){return Object(n["a"])({url:"/addActivity",method:"post",data:t})}function g(t){return Object(n["a"])({url:"/updateActivity",method:"post",data:t})}function f(t){return Object(n["a"])({url:"/deleteActivity",method:"get",params:t})}function h(t){return Object(n["a"])({url:"/limitActivitie",method:"get",params:t})}function p(t){return Object(n["a"])({url:"/addConsult",method:"post",data:t})}function v(t){return Object(n["a"])({url:"/updateConsult",method:"post",data:t})}function b(t){return Object(n["a"])({url:"/deleteConsult",method:"get",params:t})}function y(t){return Object(n["a"])({url:"/limitConsults",method:"get",params:t})}},4260:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o}));i("99af"),i("d3b7"),i("25f0");function n(t){var e,i=r(t);if("array"===i)e=[];else{if("object"!==i)return t;e={}}if("array"===i)for(var a=0,o=t.length;a<o;a++)e.push(n(t[a]));else if("object"===i)for(var s in t)e[s]=n(t[s]);return e}function a(t,e){var i=new Date(t),n=i.getFullYear(),a=i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1,o=i.getDate()<10?"0"+i.getDate():i.getDate();i.getHours(),i.getHours(),i.getMinutes(),i.getMinutes(),i.getSeconds(),i.getSeconds();return"".concat(n,"-").concat(a,"-").concat(o)}function o(t,e){var i=new Date(t),n=i.getFullYear(),a=i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1,o=i.getDate()<10?"0"+i.getDate():i.getDate(),r=i.getHours()<10?"0"+i.getHours():i.getHours(),s=i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes(),c=i.getSeconds()<10?"0"+i.getSeconds():i.getSeconds();return"yyyy-MM-dd"==e?"".concat(n,"-").concat(a,"-").concat(o):"".concat(n,"-").concat(a,"-").concat(o," ").concat(r,":").concat(s,":").concat(c)}function r(t){var e=Object.prototype.toString,i={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"};return t instanceof Element?"element":i[e.call(t)]}},"64c8":function(t,e,i){"use strict";i("72b7")},"72b7":function(t,e,i){},7848:function(t,e,i){},bf32:function(t,e,i){"use strict";i("151d")},d928:function(t,e,i){"use strict";i("7848")}}]);